function idcDiscardOrderEdit(){jQuery("#memberdeck-users td.order_item.order_edit a").show(),jQuery("#memberdeck-users td.order_item.order_edit .order_edit_field, #memberdeck-users td.order_item.order_edit a.order_edit_save, #memberdeck-users td.order_item.order_edit a.order_edit_undo").remove()}function idcCreateOrderEditObject(e){var t={id:jQuery(e).parent("tr").data("id"),column:jQuery(e).data("column"),value:jQuery(e).find("input.order_edit_field").val()};return"float"===jQuery(e).data("type")&&(t.value=idfParseFloat(t.value)),t}jQuery(document).ready(function(){jQuery("#level-delete").hide(),jQuery("#credit-delete").hide(),jQuery("#download-delete").hide(),"Choose Level"==jQuery("#edit-level").val()&&jQuery(".list-shortcode").hide(),-1!==jQuery("body").attr("class").indexOf("idc")&&jQuery("body").addClass("md-admin"),jQuery(".idc-attach-datepicker").datepicker({defaultDate:"0000-00-00",dateFormat:"mm/dd/yy"}),jQuery(".md_help_link").click(function(){var e=jQuery(this).attr("id");jQuery("#"+e+"-help").slideToggle("fast",function(){})}),jQuery("#enable_credits").length>0&&(jQuery("#enable_credits").is(":checked")?(jQuery("#credit-value").parent("div").show(),jQuery("#credit-settings-help").parent("div").show()):(jQuery("#credit-value").parent("div").hide(),jQuery("#credit-settings-help").parent("div").hide())),jQuery("#enable_credits").change(function(e){if(jQuery("#enable_credits").is(":checked"))jQuery("#credit-value").parent("div").show(),jQuery("#credit-settings-help").parent("div").show(),jQuery("#global-currency").find('option[value="credits"]').length<=0&&jQuery("#global-currency").append('<option value="credits" data-symbol="credits">'+idc_localization_strings.virtual_currency+"</option>"),jQuery(".idc-credits-field").show(),jQuery(".virtual-currency-selected").hide();else{if("credits"==jQuery("#global-currency").val()){jQuery(".virtual-currency-selected").show(),jQuery("#enable_credits").attr("checked","checked").prop("checked",!0);return}jQuery(".virtual-currency-selected").hide(),jQuery("#credit-value").parent("div").hide(),jQuery("#credit-settings-help").parent("div").hide(),"credits"==jQuery("#global-currency").val()&&jQuery("#global-currency").val("USD"),jQuery("#global-currency").find('option[value="credits"]').remove(),jQuery(".idc-credits-field").hide()}}),jQuery('input[name="show_terms"]').prop("checked"),jQuery('input[name="show_terms"]').change(function(){jQuery('input[name="show_terms"]').prop("checked"),jQuery('select[name="terms_page"], select[name="privacy_page"]').parent("div").toggle()}),jQuery('select[name="export_product_choice"]').change(function(){d()}),jQuery("#enable_default_product").length>0&&(jQuery("#enable_default_product").is(":checked")?jQuery("#default_product").parent("div").show():jQuery("#default_product").parent("div").hide()),jQuery("#enable_default_product").change(function(e){jQuery(this).is(":checked")?jQuery("#default_product").parent("div").show():jQuery("#default_product").parent("div").hide()}),jQuery('select[name="product-type"] option').length<=1&&jQuery('select[name="product-type"]').parent(".form-input").hide();var e,t=jQuery('select[name="creator_permissions"] option:selected').val();function a(e){"2"==e?jQuery("#allowed-creator-levels").show():jQuery("#allowed-creator-levels").hide()}function d(){jQuery('select[name="export_product_choice"]').val()>0?jQuery('input[name="export_customers"]').removeAttr("disabled").prop("disabled",!1):jQuery('input[name="export_customers"]').attr("disabled","disabled").prop("disabled",!0)}function c(){jQuery('input[name="export_customers"]').attr("disabled","disabled").prop("disabled",!0),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"md_export_customers"},success:function(e){console.log(e),void 0!==e&&jQuery('input[name="export_customers"]').removeAttr("disabled").prop("disabled",!1)}})}function r(){"checked"==(occEnabled=jQuery('input[name="enable_occ"]').prop("checked"))?(jQuery("#occ_level").parents(".form-input").show(),jQuery("#id_project").length>0?jQuery("#id_project").parents(".form-input").show():jQuery("#id_project").parents(".form-input").hide()):(jQuery("#occ_level").parents(".form-input").hide(),jQuery("#id_project").parents(".form-input").hide())}if(a(t),jQuery('select[name="creator_permissions"]').change(function(){a(t=jQuery('select[name="creator_permissions"] option:selected').val())}),get_levels(idc_product_filter),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idmember_get_downloads"},success:function(e){var t=JSON.parse(e);jQuery.each(t,function(){jQuery("#edit-download").append(jQuery("<option/>",{value:this.id,text:this.download_name}))}),jQuery(this).prop("checked"),jQuery('input[name="enable_occ"]').removeAttr("checked").prop("checked",!1),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"mdid_project_list"},success:function(e){e&&(json=JSON.parse(e))&&jQuery.each(json,function(){jQuery('#id_project option[value="'+this.id+'"]').length<=0&&jQuery("#id_project").append(jQuery("<option/>",{value:this.id,text:this.product_name}))})}}),jQuery("#edit-download").change(function(){var e=parseInt(jQuery("#edit-download").val());if(jQuery(".lassign").removeAttr("checked").prop("checked",!1),e){jQuery("#download-name").val(t[e].download_name),jQuery("#download-version").val(t[e].version),"1"==t[e].enable_occ?jQuery('input[name="enable_occ"]').attr("checked","checked").prop("checked",!0):jQuery('input[name="enable_occ"]').removeAttr("checked").prop("checked",!1),"1"==t[e].hidden?jQuery('input[name="hidden"]').attr("checked","checked").prop("checked",!0):jQuery('input[name="hidden"]').removeAttr("checked").prop("checked",!1),"1"==t[e].enable_s3?jQuery('input[name="enable_s3"]').attr("checked","checked").prop("checked",!0):jQuery('input[name="enable_s3"]').removeAttr("checked").prop("checked",!1),jQuery("#occ_level").val(t[e].occ_level),jQuery("#id_project").val(t[e].id_project),jQuery("#dash-position").val(t[e].position),jQuery("#licensed").val(t[e].licensed);var a=t[e].levels;jQuery.each(a,function(e,t){jQuery('.lassign[value="'+t+'"]').attr("checked","checked").prop("checked",!0)}),jQuery("#download-link").val(t[e].download_link),jQuery("#info-link").val(t[e].info_link),jQuery("#doc-link").val(t[e].doc_link),jQuery("#image-link").val(t[e].image_link),""!==t[e].image_link?(jQuery("#add-download-image").hide(),jQuery("#remove-download-image").show(),void 0!==t[e].download_image_url?jQuery("#download-image-thumnail").attr("src",t[e].download_image_url).show():jQuery("#download-image-thumnail").attr("src",t[e].image_link).show()):(jQuery("#add-download-image").show(),jQuery("#remove-download-image").hide(),jQuery("#download-image-thumnail").attr("src","").hide()),jQuery("#button-text").val(t[e].button_text),jQuery("#download-submit").val(idc_localization_strings.update),jQuery("#download-delete").show()}else jQuery("#download-name").val(""),jQuery("#download-version").val(""),jQuery('input[name="enable_s3"]').removeAttr("checked").prop("checked",!1),jQuery('input[name="hidden"]').removeAttr("checked","checked").prop("checked",!1),jQuery('input[name="enable_occ"]').removeAttr("checked").prop("checked",!1),jQuery("#occ_level").val(0),jQuery("#id_project").val(0),jQuery("#dash-position").val("a"),jQuery("#licensed").val("0"),jQuery("#download-link").val(""),jQuery("#info-link").val(""),jQuery("#doc-link").val(""),jQuery("#image-link").val(""),jQuery("#button-text").val(""),jQuery("#download-submit").val("Create"),jQuery("#download-delete").hide();r()}),jQuery('input[name="enable_occ"]').change(function(){r()})}}),d(),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idmember_get_credits"},success:function(e){credits=JSON.parse(e),jQuery.each(credits,function(){jQuery("#edit-credit").append(jQuery("<option/>",{value:this.id,text:this.credit_name}))}),jQuery("#edit-credit").change(function(){var e=parseInt(jQuery("#edit-credit").val());jQuery("#credit-name").val(credits[e].credit_name),jQuery("#credit-price").val(credits[e].credit_price),jQuery("#credit-count").val(credits[e].credit_count),jQuery("#credit-assign").val(credits[e].credit_level),jQuery("#credit-submit").val(idc_localization_strings.update),jQuery("#credit-delete").show()})}}),jQuery("#memberdeck-users td.username").click(function(e){e.preventDefault();var t=jQuery(this).parent("tr").attr("id");t&&(id=t.replace("user-",""),jQuery("#user-list, .search-box").hide(),jQuery("#user-profile").show(),jQuery(document).trigger("idc_member_admin_edit",id),jQuery.ajax({async:!1,url:md_ajaxurl,type:"POST",data:{action:"idmember_get_profile",ID:id},success:function(e){(json=JSON.parse(e)).shipping_info&&jQuery.each(json.shipping_info,function(e,t){jQuery("#user-profile ."+e).val(t)}),json.usermeta&&jQuery.each(json.usermeta,function(e,t){jQuery("#user-profile ."+e).val(t)}),json.userdata.data&&jQuery.each(json.userdata.data,function(e,t){jQuery("#user-profile ."+e).val(t)}),jQuery(document).trigger("user_profile_edit",json),jQuery("#confirm-edit-profile").click(function(e){e.preventDefault();var t={},a=jQuery("#user-profile input"),d=!1;jQuery.each(jQuery(a),function(e,a){var c=jQuery(this).attr("name");("display_name"==c||"user_email"==c)&&jQuery(this).val().length<=0&&(d=!0),"checkbox"==jQuery(this).attr("type")?"checked"==jQuery(this).prop("checked")&&(t[c]=jQuery(this).val()):t[c]=jQuery(this).val()}),t.id=id,d?(jQuery("p.error").remove(),jQuery("#user-profile").prepend('<p class="error">Error, missing or empty fields.</p>')):jQuery.ajax({async:!1,url:md_ajaxurl,type:"POST",data:{action:"idmember_edit_profile",Userdata:t},success:function(e){location.reload()}})})}}),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"admin_edit_subscription",user_id:id},success:function(e){e&&(json=JSON.parse(e),jQuery.isEmptyObject(json)||(jQuery(".postbox").show(),jQuery.each(json,function(){jQuery('select[name="sub_list"]').append('<option value="'+this.id+'">'+this.plan_id+"</option>")})))}}),jQuery('select[name="sub_list"]').change(function(){"0"!==jQuery(this).children("option:selected").val()?(jQuery(this).children("option:selected").text(),jQuery('button[name="cancel_sub"]').removeAttr("disabled").prop("disabled",!1).show()):jQuery('button[name="cancel_sub"]').attr("disabled","disabled").prop("disabled",!0).hide()}),jQuery('button[name="cancel_sub"]').click(function(e){e.preventDefault(),jQuery(".sub_response").text("").removeClass().addClass("sub_response");var t=jQuery('select[name="sub_list"]').children("option:selected").val(),a=jQuery('select[name="sub_list"]').children("option:selected").text();jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idc_cancel_sub",plan_id:t,plan:a,user_id:id},success:function(e){if(e){var t=JSON.parse(e);"success"==t.status&&(jQuery('select[name="sub_list"] option:selected').remove(),1==jQuery('select[name="sub_list"] option').size()&&jQuery('button[name="cancel_sub"]').attr("disabled","disabled").prop("disabled",!0).hide()),jQuery(".sub_response").text(t.message).addClass(t.status)}}})})),jQuery("#cancel-edit-profile").click(function(e){jQuery(".form-input").html(""),jQuery("#user-list, .search-box").show(),jQuery("#user-profile").hide(),jQuery(document).trigger("idc_member_admin_cancel"),e.preventDefault()})}),jQuery(".idc_page_idc-users select.level-selector").length>0){var s=jQuery(".idc_page_idc-users select.level-selector").data("selected");s>0&&jQuery(".idc_page_idc-users select.level-selector").val(s),jQuery(".idc_page_idc-users select.level-selector").change(function(e){var t=jQuery(this).val(),a=idfStripUrlQuery(idf_current_url)+"?page=idc-users";t>0&&(a=a+"&level="+t),location.href=a})}if(jQuery("#memberdeck-users td.current-levels").click(function(e){e.preventDefault();var t=jQuery(this).parent("tr").attr("id");t&&(id=t.replace("user-",""),jQuery("#user-list, .search-box").hide(),jQuery("#edit-user").show(),jQuery.ajax({async:!1,url:md_ajaxurl,type:"POST",data:{action:"idmember_get_levels"},success:function(e){levels=JSON.parse(e),jQuery.each(levels,function(){jQuery(".form-input").append(jQuery("<tr class='level"+this.id+"'><th class='check-column'><input type='checkbox' value='"+this.id+"'/></th><td><label>"+this.level_name+"</label></td></tr>"))})}}),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idmember_edit_user",ID:id},success:function(e){var t=jQuery(".form-input input[type='checkbox']").size()-1;if(json=JSON.parse(e),console.log(json),Object.keys(json.levels).length>0){for(i=0;i<=t;i++)jQuery(".form-input tr").eq(i).append("<td/><td></td>");jQuery.each(json.levels,function(e,t){jQuery("input[value='"+t+"']").attr("checked","checked").prop("checked",!0)})}else for(i=0;i<=t;i++)jQuery(".form-input tr").eq(i).append("<td/><td>none</td>");jQuery.each(json.levels,function(e,t){if(console.log(e),console.log(t),console.log(json),json.lasts[e]){var a=json.lasts[e].e_date,d=json.lasts[e].order_date,c=json.lasts[e].id;a&&void 0!=a&&""!=a?-1!==a.indexOf("0000-00-00 00:00:00")&&(a="lifetime"):a="lifetime",jQuery(".form-input tr.level"+t).children("td:last-child").prev().text(d),jQuery(".form-input tr.level"+t).children("td:last-child").html('<a data-id="'+c+'" class="edit-date" href="#">'+a+"</a>")}}),jQuery(".form-input").on("click",".edit-date",function(e){e.preventDefault();var t=this;oID=jQuery(this).data("id"),jQuery(this).replaceWith('<span id="edit-fields"><input type="text" name="edit-date" value="yyyy-mm-dd"/><p class="edit-options"><span class="trash"><a href="#" class="edit-cancel delete">cancel</a></span>&nbsp;|&nbsp;<a href="#" class="lifetime">non-expiring</a></span></p>'),jQuery('input[name="edit-date"]').datepicker({defaultDate:"0000-00-00",dateFormat:"yy-mm-dd",onClose:function(){var e=jQuery(this).val();jQuery("span.trash").remove(),""!==e||"yyyy-mm-dd"!==e?jQuery(this).replaceWith('<a data-id="'+oID+'" class="edit-date date-edited" href="#">'+e+"</a>"):jQuery(this).replaceWith('<a data-id="'+oID+'" class="edit-date date-edited" href="#">0000-00-00</a>')}}),jQuery(".edit-cancel").click(function(e){e.preventDefault(),jQuery("#edit-fields").replaceWith(t)}),jQuery(".lifetime").click(function(e){e.preventDefault(),jQuery("p.edit-options").remove(),jQuery('input[name="edit-date"]').replaceWith('<a data-id="'+id+'" class="edit-date date-edited" href="#">0000-00-00</a>')})})}}),jQuery("#confirm-edit").click(function(e){e.preventDefault();var t=[];jQuery.each(levels,function(){t.push({level:this.id,value:jQuery(".form-input input[value='"+this.id+"']").prop("checked")})});var a=[];jQuery.each(jQuery(".date-edited"),function(){var e=jQuery(this).data("id"),t=jQuery(this).text();a.push({id:e,date:t})}),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idmember_save_user",ID:id,Levels:t,Dates:a},success:function(e){console.log(e),e||(jQuery(".form-input").html(""),jQuery("#user-list, .search-box").show(),jQuery("#edit-user").hide(),window.location="?page=idc-users")}})})),jQuery("#cancel-edit").click(function(e){e.preventDefault(),jQuery(".form-input").html(""),jQuery("#user-list").show(),jQuery("#edit-user").hide()})}),jQuery("#memberdeck-users td.current-credits").click(function(e){e.preventDefault();var t=jQuery(this).parent("tr").attr("id");t&&(id=t.replace("user-",""),jQuery("#user-list, .search-box").hide(),jQuery("#user-credits").show(),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idmember_credit_total",ID:id},success:function(e){console.log(e),""==e&&(e=0),jQuery('input[name="current-credits"]').val(e)}}),jQuery("#confirm-credits").click(function(e){var t=jQuery('input[name="current-credits"]').val();e.preventDefault(),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idmember_save_credits",ID:id,Credits:t},success:function(e){jQuery(".form-input").html(""),jQuery("#user-list").show(),jQuery("#user-credits").hide(),window.location="?page=idc-users"}})})),jQuery("#cancel-credits").click(function(e){e.preventDefault(),jQuery(".form-input").html(""),jQuery("#user-list").show(),jQuery("#user-credits").hide()})}),jQuery("#memberdeck-users td.order_item.order_edit a").click(function(e){jQuery(document).trigger("idcOrderItemEdit",jQuery(this))}),jQuery("#assign-checkbox .select").click(function(e){e.preventDefault(),jQuery(".lassign").attr("checked","checked").prop("checked",!0)}),jQuery("#assign-checkbox .clear").click(function(e){e.preventDefault(),jQuery(".lassign").removeAttr("checked").prop("checked",!1)}),jQuery.getJSON(md_currencies,function(e){jQuery.each(e.currency,function(){jQuery("#pp-currency").append('<option value="'+this.code+'" data-symbol="'+this.symbol+'">'+this.code+"</option>");var e=jQuery("#pp-currency").data("selected");jQuery("#pp-currency").val(e),jQuery("#ppada_currency").length>0&&jQuery("#ppada_currency").append('<option value="'+this.code+'" data-symbol="'+this.symbol+'">'+this.code+"</option>")}),jQuery("#pp-currency").change(function(){var e=jQuery(this).find(":selected").data("symbol");jQuery('input[name="pp-symbol"]').val(e)})}),jQuery.getJSON(idc_global_currencies,function(e,t){if(jQuery.each(e,function(){jQuery("#global-currency").length>0&&jQuery("#global-currency").append('<option value="'+this.Currency_Code+'" data-symbol="'+this.Symbol+'">'+this.Currency_Code+"</option>")}),jQuery("#global-currency").length>0){var a=jQuery("#global-currency").data("selected");jQuery("#global-currency").append('<option value="BTC" data-symbol="BTC">BTC</option>'),jQuery("#enable_credits").is(":checked")?jQuery("#global-currency").append('<option value="credits" data-symbol="credits">'+idc_localization_strings.virtual_currency+"</option>"):"credits"==a&&(a="USD"),jQuery("#global-currency").val(a)}}),jQuery("#gateway-settings").length>0&&jQuery("#stripe_currency").length>0&&jQuery.getJSON(idc_stripe_currencies,function(e,t){jQuery.each(e,function(){jQuery("#stripe_currency").append('<option value="'+this.code+'">'+this.code+"</option>")});var a=jQuery("#stripe_currency").data("selected");jQuery("#stripe_currency").val(a)}),jQuery(".cc-gateway-chkbox:checked").length>0){var n=jQuery(".cc-gateway-chkbox:checked").get(0);if(void 0!==jQuery(n).attr("siblings")){var l=jQuery(n).attr("siblings");jQuery('[siblings="'+l+'"]').get(0),jQuery(".cc-gateway-chkbox").not('.cc-gateway-chkbox[siblings="'+l+'"]').removeAttr("checked").prop("checked",!1).attr("disabled","disabled").prop("disabled",!0)}else{var o=jQuery(n).attr("id");jQuery(".cc-gateway-chkbox").not('.cc-gateway-chkbox[id="'+o+'"]').removeAttr("checked").prop("checked",!1).attr("disabled","disabled").prop("disabled",!0)}}if(jQuery(".cc-gateway-chkbox").click(function(e){var t=jQuery(this);if(t.is(":checked")){if(void 0!==t.attr("siblings"))var a=t.attr("siblings"),d=jQuery('[siblings="'+a+'"]').get(0);else var d=null;null!==d?jQuery(d).is(":checked")&&t.attr("id")==jQuery(d).attr("id")?(jQuery(".cc-gateway-chkbox").removeAttr("checked").prop("checked",!1).attr("disabled","disabled").prop("disabled",!0),jQuery('[siblings="'+a+'"]').removeAttr("disabled").prop("disabled",!1),t.attr("checked","checked").prop("checked",!0)):jQuery(d).is(":checked")&&(jQuery(".cc-gateway-chkbox").not('.cc-gateway-chkbox[siblings="'+a+'"]').removeAttr("checked").prop("checked",!1).attr("disabled","disabled").prop("disabled",!0),jQuery('[siblings="'+a+'"]').removeAttr("disabled").prop("disabled",!1),t.attr("checked","checked").prop("checked",!0),jQuery(d).attr("checked","checked").prop("checked",!0)):(jQuery(".cc-gateway-chkbox").removeAttr("checked").prop("checked",!1).attr("disabled","disabled").prop("disabled",!0),t.attr("checked","checked").prop("checked",!0).removeAttr("disabled").prop("disabled",!1))}else{if(void 0!==t.attr("siblings"))var a=t.attr("siblings"),d=jQuery('[siblings="'+a+'"]').get(0);else var d=null;null!==d&&jQuery(d).is(":checked")||(null===d||jQuery(d).is(":checked"))&&null!=d||jQuery(".cc-gateway-chkbox").removeAttr("disabled").prop("disabled",!1)}}),jQuery("#epp").click(function(e){jQuery(this).is(":checked")&&jQuery("#eppadap").prop("checked",!1)}),jQuery("#eppadap").click(function(e){jQuery(this).is(":checked")&&jQuery("#epp").prop("checked",!1)}),jQuery(".enable_paypal").length>0){var p=jQuery(".enable_paypal:checked").attr("name");u(p),h(p),jQuery(".enable_paypal").change(function(e){u(p=jQuery(".enable_paypal:checked").attr("name")),h(p)}),jQuery('input[name="test"]').change(function(){h(p=jQuery(".enable_paypal:checked").attr("name")),u(p)}),jQuery("#ppadap_max_preauth_period").keyup(function(e){!1===/[0-9]/.test(jQuery("#ppadap_max_preauth_period").val())?jQuery(this).val(""):jQuery(this).val()>364&&jQuery(this).val("364")})}function u(e){void 0==e?jQuery(".enable_paypal").removeAttr("disabled").prop("disabled",!1):jQuery(".enable_paypal:not(:checked)").attr("disabled","disabled").prop("disabled",!0)}function h(e){jQuery(".test-field").hide(),jQuery(".live-field").hide(),jQuery('input[name="test"]').is(":checked")?"epp"==e||void 0==e?jQuery(".pp-standard-field.test-field").show():"eppadap"==e&&jQuery(".pp-adaptive-field.test-field").show():"epp"==e||void 0==e?jQuery(".pp-standard-field.live-field").show():"eppadap"==e&&jQuery(".pp-adaptive-field.live-field").show()}jQuery("#enable_sendgrid").change(function(){"checked"==jQuery(this).prop("checked")?jQuery("#enable_mandrill").removeAttr("checked").prop("checked",!1).attr("disabled","disabled").prop("disabled",!0):jQuery("#enable_mandrill").removeAttr("disabled").prop("disabled",!1)}),jQuery("#enable_mandrill").change(function(){"checked"==jQuery(this).prop("checked")?jQuery("#enable_sendgrid").removeAttr("checked").prop("checked",!1).attr("disabled","disabled").prop("disabled",!0):jQuery("#enable_sendgrid").removeAttr("disabled").prop("disabled",!1)}),jQuery("#charge-screen").length>0&&jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idmember_get_levels",filter:{where:"txn_type",value:"preauth"}},success:function(e){e&&(json=JSON.parse(e),jQuery.each(json,function(e,t){jQuery(".md-settings-container #level-list").append(jQuery("<option/>",{value:this.id,text:this.level_name}))}))}}),jQuery("#btnProcessPreauth").click(function(e){e.preventDefault(),jQuery("#charge-notice").hide(),jQuery("#charge-notice .success-count, #charge-notice .fail-count").text(""),jQuery(this).attr("disabled","disabled").prop("disabled",!0);var t=jQuery("#level-list").val();jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"md_process_preauth",Level:t},success:function(e){void 0!==(json=JSON.parse(e)).counts?jQuery("#charge-confirm").html('<div id="charge-notice" class="updated fade below-h2" id="message"><p><span class="success-count">'+json.counts.success+'</span> Successful Transactions Processed, <span class="fail-count">'+json.counts.failures+'</span> Failed Transactions.</p><a id="close-notice" href="#">Close</a></div>'):jQuery("#charge-confirm").html('<div id="charge-notice" class="updated fade below-h2" id="message"><p><span class="success-count">'+json.message+'</p><a id="close-notice" href="#">Close</a></div>'),jQuery("#charge-notice").show(),jQuery("#close-notice").click(function(e){jQuery("#charge-notice").is(":visible")&&jQuery("#charge-notice").hide()}),jQuery("#btnProcessPreauth").removeAttr("disabled").prop("disabled",!1)}})}),jQuery("#add-download-image").click(function(t){if(t.preventDefault(),e){e.open();return}(e=wp.media.frames.idc_download_image_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1})).on("select",function(){attachment=e.state().get("selection").first().toJSON(),console.log("attachment: ",attachment),jQuery("#image-link").val(attachment.id),void 0!==attachment.sizes.thumbnail?jQuery("#download-image-thumnail").attr("src",attachment.sizes.thumbnail.url).show():jQuery("#download-image-thumnail").attr("src",attachment.sizes.full.url).show(),jQuery("#add-download-image").hide(),jQuery("#remove-download-image").show()}),e.open()}),jQuery("#remove-download-image").click(function(e){jQuery("#add-download-image").show(),jQuery(this).hide(),jQuery("#download-image-thumnail").attr("src","").hide(),jQuery("#image-link").val("")}),jQuery(".pre-order-status-link").click(function(e){jQuery(this).data("order-id")>0&&(jQuery(".preorder-status p.preorder-status-date").text(jQuery(this).data("preorder-status-date")),jQuery(".preorder-status p.preorder-status-error").text(jQuery(this).data("preorder-status-error")))})}),jQuery(document).bind("idcOrderItemEdit",function(e,t){idcDiscardOrderEdit();var a=jQuery(t).text(),d=jQuery(t).parent("td");jQuery(t).hide(),jQuery(t).after('<input type="text" data-item="'+jQuery(d).attr("id")+'" class="order_edit_field" value="'+a+'"/> <a href="#" class="order_edit_undo"><i class="fa fa-undo"></i></a> <a href="#'+d+'" class="order_edit_save"><i class="fa fa-save"></i></a>'),jQuery("#memberdeck-users td.order_item.order_edit a.order_edit_undo").click(function(e){jQuery(document).trigger("idcOrderItemUndo",d)}),jQuery("#memberdeck-users td.order_item.order_edit a.order_edit_save").click(function(e){jQuery(document).trigger("idcOrderItemSave",d)}),jQuery("#memberdeck-users td.order_item.order_edit input.order_edit_field").keydown(function(e){"13"==e.keyCode&&(e.preventDefault(),jQuery(document).trigger("idcOrderItemSave",d))})}),jQuery(document).bind("idcOrderItemUndo",function(e,t){idcDiscardOrderEdit()}),jQuery(document).bind("idcOrderItemSave",function(e,t){var a=idcCreateOrderEditObject(t);jQuery(document).trigger("idcOrderItemUpdate",a)}),jQuery(document).bind("idcOrderItemUpdate",function(e,t){console.log(t),jQuery.ajax({url:md_ajaxurl,type:"POST",data:{action:"idc_order_item_update",args:t},success:function(e){if(void 0!==e&&e){var a=jQuery('tr[data-id="'+t.id+'"]').data("currency-code");jQuery("#"+t.column+"-"+t.id+" a").text(a+t.value),idcDiscardOrderEdit()}}})}),jQuery(document).ready(function(e){e("#aws-s3-connection-test").on("submit",function(t){t.preventDefault();var a=e(this),d=a.find(".spinner"),c=a.find(".aws_success_msg"),r=a.find(".aws_error_msg");d.addClass("is-active"),e.ajax({url:md_ajaxurl,type:"POST",dataType:"json",data:{action:"idc_aws_s3_connection_test"},success:function(e){e.success?(c.text(e.data.message).css("display","block"),r.css("display","none")):(r.text(e.data.message).css("display","block"),c.css("display","none"))},error:function(e,t,a){r.text(e.responseJSON.message).css("display","block"),c.css("display","none")},complete:function(){d.removeClass("is-active")}})})});