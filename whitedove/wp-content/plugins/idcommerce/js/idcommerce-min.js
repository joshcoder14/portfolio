var scpk,idcPayVars={isGuestCheckout:0,redirectURL:memberdeck_durl,idSet:0,isFree:0,trial:{trialPeriod:"",trialLength:"",trialType:""}},mc=memberdeck_mc,epp=memberdeck_epp,es=memberdeck_es,ecb=0,eauthnet=memberdeck_eauthnet,eppadap=memberdeck_eppadap,onlyStripe="1"===es&&"1"!==mc&&"1"!==ecb&&"1"!==epp&&"1"!==eauthnet&&"1"!==eppadap;function idcIsLoggedIn(){return jQuery("#payment-form #logged-input").hasClass("yes")}function setGuestCheckout(){idcPayVars.isGuestCheckout=0,jQuery("#payment-form").data("guest-checkout")&&!idcIsLoggedIn()&&jQuery("#payment-form input.pw").is(":hidden")&&(idcPayVars.isGuestCheckout=1,idcPayVars.redirectURL=idfStripUrlQuery(idf_current_url))}function setIdcPayObj(){idcPayVars.idSet=jQuery("#payment-form #stripe-input").data("idset"),idcPayVars.isFree=jQuery("#payment-form").data("free")}function no_methods(){var e=jQuery("#payment-form .pay_selector").length;if(e<1)"free"!==idcPayVars.isFree&&(jQuery(".finaldesc").hide(),jQuery("#stripe-input").hide(),jQuery("#payment-form #id-main-submit").text(idc_localization_strings.no_payments_available).attr("disabled","disabled"));else if(1==e){var t=jQuery("#payment-form .pay_selector");jQuery(document).trigger("idcPaySelect",t),jQuery(".payment-type-selector").hide();var a=0;1==es?(idcSetSubmitName("Stripe"),a=1):"pay-with-fd"==jQuery("#payment-form .pay_selector").attr("id")?(idcSetSubmitName("FD"),a=1):1!=eauthnet||idcPayVars.isGuestCheckout||(idcSetSubmitName("Authorize"),a=1),idcPayVars.idSet||1!=a||(jQuery("#id-main-submit").text(idc_localization_strings.complete_checkout),jQuery("#payment-form #stripe-input").show(),jQuery("#finaldescStripe").show(),jQuery(".card-number, .card-cvc, card-expiry-month, card-expiry-year").addClass("required"),jQuery("#id-main-submit").prop("disabled",!1))}return e}function idcCheckoutErrorClass(){return"error"}function idcCheckoutFormData(){return{fname:jQuery(".first-name").val(),lname:jQuery(".last-name").val(),email:jQuery("#payment-form .email").val(),pw:jQuery(".pw").val(),cpw:jQuery(".cpw").val(),pid:jQuery("#payment-form").data("product")}}function idcCheckoutExtraFields(){var e=jQuery("#extra_fields input, #extra_fields select"),t={posts:{}};jQuery.each(e,function(e,a){var i=jQuery(this).attr("name"),r=jQuery(this).attr("type");"checkbox"==r||"radio"==r?!0==jQuery(this).prop("checked")&&(value=jQuery(this).val(),t.posts[e]={},t.posts[e].name=i,t.posts[e].value=value):"SELECT"==this.tagName.toUpperCase()?(value=jQuery(this).find(":selected").val(),t.posts[e]={},t.posts[e].name=i,t.posts[e].value=value):(value=encodeURIComponent(jQuery(this).val()),t.posts[e]={},t.posts[e].name=i,t.posts[e].value=value)});var a="";return jQuery.each(t.posts,function(){a=a+"&"+this.name+"="+this.value}),t}function idcCheckoutCustomer(){var e=jQuery("#payment-form").data("product"),t=jQuery(".first-name").val(),a=jQuery(".last-name").val(),i=jQuery("#payment-form .email").val(),r=jQuery(".pw").val();return{product_id:e,first_name:t,last_name:a,email:i,pw:r}}function idcSelClass(e){return jQuery(e).attr("id").replace("pay-with-","")}function idcPaySelectActions(e){var t=jQuery(".currency-symbol").children("sup").text(),a=jQuery(".currency-symbol .product-price").text(),i=jQuery("#payment-form").data("type"),r=jQuery("#payment-form").data("txn-type");switch(selClass=idcSelClass(e)){case"stripe":t=jQuery("#stripe-input").data("symbol"),idcSetSubmitName("Stripe"),jQuery("#id-main-submit").text(idc_localization_strings.complete_checkout),jQuery(".finaldesc").hide(),jQuery("#finaldescStripe").show(),idcIdSet();break;case"paypal":idcSetSubmitName("Paypal"),jQuery("#id-main-submit").text(idc_localization_strings.pay_with_paypal),jQuery("#stripe-input, .finaldesc").hide(),jQuery("#finaldescPayPal").show(),jQuery(".card-number, .card-cvc, .card-expiry-month, .card-expiry-year").removeClass("required"),"recurring"==i?loadPpForm("_ppSubForm"):loadPpForm("_ppForm"),idcHideRegistration();break;case"ppadaptive":idcSetSubmitName("PPAdaptive"),jQuery("#id-main-submit").text(idc_localization_strings.pay_with_paypal),jQuery("#stripe-input, .finaldesc").hide(),jQuery("#finaldescPayPal").show(),"recurring"==i||"preauth"==r?loadPpForm("_ppAdaptiveSubForm"):loadPpForm("_ppAdaptiveForm"),idcHideRegistration();break;case"fd":t="$",idcSetSubmitName("FD"),jQuery("#id-main-submit").text(idc_localization_strings.complete_checkout),jQuery(".finaldesc").hide(),jQuery("#finaldescStripe").show(),idcIdSet();break;case"mc":t=jQuery("#finaldescOffline").data("currency-symbol"),idcSetSubmitName("MC"),jQuery("#id-main-submit").text(idc_localization_strings.complete_checkout),jQuery("#stripe-input, .finaldesc").hide(),jQuery("#finaldescOffline").show();break;case"credits":idcSetSubmitName("Credits"),jQuery("#id-main-submit").text(idc_localization_strings.complete_checkout),jQuery("#stripe-input, .finaldesc").hide(),jQuery("#finaldescCredits").show();break;case"coinbase":t=jQuery("#finaldescCoinbase").data("cb-symbol"),idcSetSubmitName("Coinbase"),jQuery("#id-main-submit").text(idc_localization_strings.pay_with_coinbase),jQuery("#stripe-input, .finaldesc").hide(),jQuery("#finaldescCoinbase").show(),jQuery(".card-number, .card-cvc, .card-expiry-month, .card-expiry-year").removeClass("required"),idcHideRegistration();break;case"authorize":t="$",idcSetSubmitName("Authorize"),jQuery("#id-main-submit").text(idc_localization_strings.complete_checkout),jQuery(".finaldesc").hide(),jQuery("#finaldescStripe").show(),idcIdSet()}1==idcPayVars.trial.trialPeriod?jQuery("#finaldescTrial").show():jQuery("#finaldescTrial").hide(),jQuery("#id-main-submit").prop("disabled",!1),idcSetPriceText(selClass,t,a)}function idcSetSubmitName(e){var t="submitPayment"+e;jQuery("#id-main-submit").attr("name",t),jQuery(document).trigger("idcSetSubmitName",t)}function idcIdSet(){idcPayVars.idSet||(jQuery("#stripe-input").show(),idcShowRegistration(),jQuery(".card-number, .card-cvc, card-expiry-month, card-expiry-year").addClass("required"))}function idcHideRegistration(){jQuery(".pw").parents(".form-row").hide(),jQuery(".cpw").parents(".form-row").hide()}function idcShowRegistration(){jQuery(".pw").parents(".form-row").show(),jQuery(".cpw").parents(".form-row").show()}function idcSetPriceText(e,t,a){if("credits"==e){var i=jQuery("#finaldescCredits .credit-value").text();jQuery(".currency-symbol").children("sup").text(t),jQuery("#payment-form .product-price").text(i)}else jQuery(".currency-symbol").children("sup").text()!==t&&jQuery(".currency-symbol").children("sup").text(t),jQuery("#payment-form .product-price").text(a)}function setTrialObj(){idcPayVars.trial={trialPeriod:parseInt(jQuery("#payment-form").data("trial-period")),trialLength:parseInt(jQuery("#payment-form").data("trial-length")),trialType:jQuery("#payment-form").data("trial-type")}}function isTerms(){return jQuery(".idc-terms-checkbox").length>0}function isTermsChecked(){return jQuery(".terms-checkbox-input").is(":checked")}function loadPpForm(e=""){jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"load_pp_form",page:e},success:function(e){"false"!=e&&jQuery("#ppload").html(e)}})}jQuery(document).ready(function(){var e=idcCheckoutErrorClass();if(jQuery(".checkout-tooltip").on("mouseover",function(){jQuery(this).hasClass("tooltip-active")?(jQuery(this).removeClass("tooltip-active"),jQuery(".tooltip-text").css("height","0"),jQuery(".tooltip-text").css("visibility","hidden"),jQuery(".checkout-tooltip i").removeClass("tooltip-color")):(jQuery(this).addClass("tooltip-active"),jQuery(".tooltip-text").css("visibility","visible"),jQuery(".tooltip-text").css("height","30px"),jQuery(".checkout-tooltip i").addClass("tooltip-color"))}),jQuery(".tooltip-text i.close").on("mouseover",function(){jQuery(".tooltip-text").removeClass("tooltip-text-hover"),jQuery(".checkout-tooltip i").removeClass("tooltip-color")}),jQuery(".idc_shortcode_button").on("click",function(){var e=jQuery(this).data("source");e.length>0&&openLBGlobal(e)}),jQuery(".idc_button_lightbox .level_select").on("change",function(){var e=jQuery(this).find("option:selected").val();jQuery('.idc_button_lightbox input[name="product_id"]').val(e)}),jQuery(".idc_button_submit").on("click",function(e){if(e.preventDefault(),jQuery(".payment-errors").hide(),jQuery('input[name="price"]').length>0)t=parseFloat(jQuery('input[name="price"]').val());else{t=parseFloat(jQuery('input[name="total"]').val());var t,a=parseFloat(jQuery(".idc_button_lightbox .level_select option:selected").data("price"));if(t<a){jQuery(".payment-errors").show();return}}var i=jQuery('form[name="idc_button_checkout_form"]').attr("action");if(i=i+"?idc_button_submit=1&price="+t,parseFloat(jQuery(".idc-button-default-price").data("level-price"))>t)return jQuery(".button-error-placeholder .payment-errors").show(),!1;jQuery(".button-error-placeholder .payment-errors").hide(),jQuery('form[name="idc_button_checkout_form"]').attr("action",i).submit()}),jQuery('input[name="price"]').on("change",function(e){var t=parseFloat(jQuery(this).val()),a=parseFloat(jQuery(".idc-button-default-price").data("level-price"));a>t&&jQuery(this).val(a)}),jQuery(".dashboardmenu").length>0&&jQuery(".dashboardmenu .active").length<=0&&jQuery(".dashboardmenu li").eq(0).addClass("active"),jQuery("form#payment-settings input").length<=1&&jQuery('input[name="creator_settings_submit"]').hide(),jQuery(".checkout-wrapper").length>0){jQuery(document).trigger("idcCheckoutLoaded");var t,a=jQuery("#payment-form").data("pay-by-credits"),i=jQuery("#payment-form").data("type");setTrialObj();var r=jQuery("#payment-form").data("limit-term");jQuery("#payment-form").data("term-length"),r&&(jQuery("#payment-form #pay-with-paypal").hide(),epp=0),idcIsLoggedIn();var s=jQuery("#payment-form").data("renewable");if("1"==es)var n=jQuery("#stripe-input").data("symbol");if(jQuery("#stripe-input").data("customer-id"),jQuery(".currency-symbol").children("sup").text(),1===a)var o=jQuery("#finaldescCredits").data("credits-label");var c,p=jQuery("#finaldescCoinbase").data("cb-symbol"),d=jQuery("#payment-form").data("txn-type");scpk=(c=jQuery("#payment-form").data("scpk"),idcPayVars.scpk=c,c),t=jQuery("#payment-form").data("claimedpp"),idcPayVars.claim_paypal=t;var m=jQuery('input[name="reg-price"]').val(),l=parseFloat(jQuery('input[name="pwyw-price"]').val()),u=jQuery(".currency-symbol .product-price").text();"preauth"==d&&(jQuery("#payment-form #pay-with-paypal").parent("div").remove(),jQuery("#payment-form #pay-with-coinbase").parent("div").remove(),jQuery("#finaldescCoinbase").remove(),"1"==idc_elw&&"3dsecure"==idc_lemonway_method&&jQuery("#payment-form #pay-with-lemonway").parent("div").remove(),no_methods()),"recurring"==i&&(jQuery("#payment-form").data("recurring"),jQuery("#payment-form #pay-with-fd").parent("div").remove(),jQuery("#payment-form #pay-with-mc").parent("div").remove(),jQuery("#payment-form #pay-with-lemonway").parent("div").remove(),parseFloat(l)>=1&&parseFloat(m)<parseFloat(l)&&jQuery("#pay-with-stripe").parent("div").remove(),no_methods()),"free"==idcPayVars.isFree?(jQuery(".checkout-payment").hasClass("active")&&(jQuery(".checkout-payment").removeClass("active"),jQuery(".checkout-confirmation").addClass("active")),jQuery(".idc-terms-checkbox").length>0&&jQuery(".idc-terms-checkbox").show(),jQuery(".main-submit-wrapper").show(),jQuery(".confirm-screen").show(),jQuery(".checkout-header").hide(),jQuery("#payment-form #id-main-submit").text(idc_localization_strings.continue)):jQuery("#payment-form .pay_selector").length>1?(jQuery("#payment-form #id-main-submit").text(idc_localization_strings.choose_payment_method),jQuery("#payment-form #id-main-submit").prop("disabled",!0)):y()}function y(){if(jQuery("#payment-form .pay_selector").hide(),jQuery("#payment-form .checkout-header").hide(),jQuery("#id-main-submit").prop("disabled",!1),jQuery(".checkout-payment").hasClass("active")&&(jQuery(".checkout-payment").removeClass("active"),jQuery(".checkout-confirmation").addClass("active")),jQuery(".pay_selector").parent("div").addClass("single-payment-selector"),jQuery(".idc-terms-checkbox").length>0&&jQuery(".idc-terms-checkbox").show(),jQuery(".main-submit-wrapper").show(),jQuery(".confirm-screen").show(),1==epp&&"preauth"!==d)jQuery("#payment-form #id-main-submit").text(idc_localization_strings.pay_with_paypal),jQuery("#payment-form #id-main-submit").attr("name","submitPaymentPaypal"),"recurring"==i?loadPpForm("_ppSubForm"):loadPpForm("_ppForm"),idcHideRegistration(),jQuery("#payment-form #finaldescPayPal").show(),jQuery("#payment-form #finaldescCredits").hide(),jQuery("#payment-form #finaldescOffline").hide(),jQuery("#payment-form .reveal-account").hide();else if("1"==mc&&"recurring"!==i){jQuery("#payment-form #pay-with-paypal").parent("div").remove(),jQuery("#payment-form #id-main-submit").text(idc_localization_strings.complete_checkout),jQuery("#payment-form #id-main-submit").attr("name","submitPaymentMC"),jQuery("#finaldescStripe").hide(),jQuery("#finaldescPayPal").hide(),jQuery("#finaldescCredits").hide(),jQuery("#finaldescOffline").show();var e=jQuery("#finaldescOffline").data("currency-symbol");idcSetPriceText("mc",e,u)}else if(1===a){jQuery("#payment-form #pay-with-paypal").parent("div").remove(),jQuery("#payment-form #id-main-submit").text(idc_localization_strings.complete_checkout),jQuery("#payment-form #id-main-submit").attr("name","submitPaymentCredits"),jQuery("#payment-form #finaldescCredits").show(),jQuery("#payment-form #finaldescCoinbase").hide(),jQuery("#payment-form #finaldescOffline").hide();var t=jQuery("#finaldescCredits .credit-value").text();jQuery(".currency-symbol").children("sup").html(o),jQuery(".currency-symbol").children(".product-price").html(t)}else"1"===ecb?(jQuery("#payment-form #id-main-submit").text(idc_localization_strings.pay_with_coinbase),jQuery("#payment-form #id-main-submit").attr("name","submitPaymentCoinbase"),jQuery("#payment-form #finaldescCoinbase").show(),jQuery("#payment-form #finaldescCredits").hide(),jQuery("#payment-form #finaldescOffline").hide(),jQuery("#finaldescPayPal").hide(),jQuery(".currency-symbol").children("sup").text(p)):"1"===eppadap?(jQuery("#payment-form #id-main-submit").text(idc_localization_strings.pay_with_paypal),jQuery("#payment-form #id-main-submit").attr("name","submitPaymentPPAdaptive"),idcHideRegistration(),"recurring"==i||"preauth"==d?loadPpForm("_ppAdaptiveSubForm"):loadPpForm("_ppAdaptiveForm"),jQuery("#payment-form #finaldescCoinbase").hide(),jQuery("#payment-form #finaldescStripe").hide(),jQuery("#payment-form #finaldescOffline").hide(),jQuery("#payment-form #finaldescPayPal").show(),jQuery("#payment-form .reveal-account").hide()):(jQuery("#payment-form #pay-with-paypal").parent("div").remove(),jQuery("#payment-form #id-main-submit").text(idc_localization_strings.complete_checkout),jQuery("#payment-form #finaldescCoinbase").hide(),jQuery("#payment-form #finaldescOffline").hide(),jQuery(".card-number, .card-cvc, card-expiry-month, card-expiry-year").addClass("required"),idcPayVars.idSet||idcShowRegistration(),"pay-with-stripe"==jQuery("#payment-form .pay_selector").attr("id")?(jQuery("#payment-form #id-main-submit").attr("name","submitPaymentStripe"),jQuery(".currency-symbol").children("sup").text(n)):"pay-with-fd"==jQuery("#payment-form .pay_selector").attr("id")&&jQuery("#payment-form #id-main-submit").attr("name","submitPaymentFD"));no_methods()}jQuery(document).on("idc_tps_option",function(){y()});var f="";function h(e,t){var a=parseFloat(jQuery('input[name="pwyw-price"]').val()),i=jQuery("#extra_fields input, #extra_fields select"),r={posts:{}};jQuery.each(i,function(e,t){var a=jQuery(this).attr("name"),i=jQuery(this).attr("type");"checkbox"==i||"radio"==i?!0==jQuery(this).prop("checked")&&(value=jQuery(this).val(),r.posts[e]={},r.posts[e].name=a,r.posts[e].value=value):"SELECT"==this.tagName.toUpperCase()?(value=jQuery(this).find(":selected").val(),r.posts[e]={},r.posts[e].name=a,r.posts[e].value=value):(value=encodeURIComponent(jQuery(this).val()),r.posts[e]={},r.posts[e].name=a,r.posts[e].value=value)});var n="";if(jQuery.each(r.posts,function(){n=n+"&"+this.name+"="+encodeURIComponent(this.value)}),t.error)jQuery(".payment-errors").text(t.error.message),jQuery(".submit-button").prop("disabled",!1).removeClass("processing"),jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout);else{jQuery("#id-main-submit").text(idc_localization_strings.processing+"...");var o=jQuery("#payment-form"),c=t.id;o.append('<input type="hidden" name="stripeToken" value="'+c+'"/>');var p=jQuery("#payment-form").data("product"),m=jQuery(".first-name").val(),l=jQuery(".last-name").val(),u=jQuery("#payment-form .email").val(),y=jQuery(".pw").val();jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_create_customer",Source:"stripe",Customer:{product_id:p,first_name:m,last_name:l,email:u,pw:y},Token:c,Fields:r.posts,txnType:d,Renewable:s,PWYW:a},success:function(e){if(console.log(e),"success"==(json=JSON.parse(e)).response){var t=json.paykey,a=json.product,i=json.order_id,s=json.user_id,o=json.type,c=json.customer_id;jQuery(document).trigger("idcPaymentSuccess",[i,c,s,a,t,r,o]),jQuery(document).trigger("stripeSuccess",[i,c,s,a,t,r,o]),setTimeout(function(){window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+a+"&paykey="+t+n},1e3)}else jQuery("#id-main-submit").prop("disabled",!1).text("").removeClass("processing"),"pay-with-paypal"==jQuery(".payment-type-selector .active").attr("id")?jQuery("#id-main-submit").text(idc_localization_strings.pay_with_paypal):jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(json.message)}})}}function v(e,t){if(jQuery('[name="upgrade-level-price"]').length>0)var a=jQuery('[name="upgrade-level-price"]').val();else if(s)var a=e.renewal_price;else{var a=e.level_price;a=a||0}if(parseFloat(t)>0&&parseFloat(t)>parseFloat(a))var i=t;else var i=a;return i}function b(){jQuery(".buy-tooltip").data("levelid",null),jQuery(".buy-tooltip").data("pid",null);var e=jQuery(".buy-tooltip");jQuery(".buy-tooltip").hide(),jQuery(e).find(".tt-product-name").text(""),jQuery(e).find(".tt-price").text(""),jQuery(e).find(".tt-credit-value").text(""),jQuery(e).find(".tt-more").attr("href",""),jQuery(e).find(".tt-credit-sep, .credits-avail, .credit-text").show()}if(jQuery(".link-terms-conditions a").on("click",function(e){return openLBGlobal(jQuery(".idc-terms-conditions")),!1}),jQuery(".link-privacy-policy a").on("click",function(e){return openLBGlobal(jQuery(".idc-privacy-policy")),!1}),jQuery(".idc_lightbox_attach").length>0&&openLBGlobal(jQuery(".idc_lightbox_attach")),jQuery(".pay_selector").on("click",function(e){e.preventDefault(),jQuery(document).trigger("idcPaySelect",this),jQuery(".checkout-payment").hasClass("active")&&(jQuery(".checkout-payment").removeClass("active"),jQuery(".checkout-confirmation").addClass("active")),jQuery(".idc-terms-checkbox").length>0&&jQuery(".idc-terms-checkbox").show(),jQuery(".main-submit-wrapper").show(),jQuery(".confirm-screen").show()}),jQuery(document).on("idcPaySelect",function(e,t){e.preventDefault(),jQuery(".pay_selector").removeClass("active"),jQuery(t).addClass("active"),idcPaySelectActions(t),setGuestCheckout()}),jQuery(document).bind("idc_no_methods",function(){no_methods()}),jQuery(".reveal-login").on("click",function(e){e.preventDefault(),jQuery("#payment-form").hide(),jQuery(".disclaimer").hide(),jQuery(".login-form").show()}),jQuery(".hide-login").on("click",function(e){e.preventDefault(),jQuery("#payment-form").show(),jQuery(".disclaimer").show(),jQuery(".login-form").hide()}),jQuery(".reveal-account").on("click",function(e){e.preventDefault(),jQuery(this).hide(),jQuery("#create_account").show(),setGuestCheckout()}),jQuery("#id-main-submit").on("click",function(t){if(t.preventDefault(),!function t(){var a,r=!1,n=idcCheckoutErrorClass(),o="";jQuery("#id-main-submit").attr("disabled","disabled").prop("disabled",!0).addClass("processing"),jQuery(".payment-errors").html(""),jQuery("#payment-form input, #payment-form select").removeClass(n),jQuery("#stripe-input").is(":visible")&&(r=function t(){var a=!1;if(jQuery("#stripe-input input.card-number").length>0){var i=jQuery("#stripe-input input.card-number"),r=jQuery("#stripe-input input.card-cvc"),s=jQuery("#stripe-input input.card-expiry-month"),n=jQuery("#stripe-input input.card-expiry-year"),o=jQuery("#stripe-input input.zip-code");jQuery(i).val().length<10?(jQuery(i).addClass(e),jQuery(i).siblings(".error-info").show(),a=!0):(jQuery(i).removeClass(e),jQuery(i).siblings(".error-info").hide()),jQuery(r).val().length<1?(jQuery(r).addClass(e),jQuery(r).siblings(".error-info").show(),a=!0):(jQuery(r).removeClass(e),jQuery(r).siblings(".error-info").hide()),jQuery(s).val().length<1?(jQuery(s).addClass(e),a=!0):jQuery(s).val().length>2?(jQuery(s).addClass(e),a=!0):jQuery(s).removeClass(e),jQuery(n).val().length<1?(jQuery(n).addClass(e),a=!0):jQuery(n).val().length>4?(jQuery(n).addClass(e),a=!0):jQuery(n).removeClass(e),o.length>0&&(jQuery(o).val().length<1?(jQuery(o).addClass(e),jQuery(o).siblings(".error-info").show(),a=!0):(jQuery(o).removeClass(e),jQuery(o).siblings(".error-info").hide()))}return a}());var c=jQuery("#payment-form input.required:visible, #payment-form select.required:visible"),p=!1;if(jQuery.each(c,function(e,t){var a=jQuery(t).val();(""==a||void 0===a)&&(jQuery(this).addClass(n),r=!0,p=!0)}),!idcIsLoggedIn()){var m=idcCheckoutFormData(),l=!1;idfValidateEmail(m.email)||(jQuery("#payment-form .email").addClass(n),r=!0,l=!0),jQuery(".pw").is(":visible")&&m.pw!==m.cpw&&(o=o+" "+idc_localization_strings.pass_dont_match+".",jQuery(".pw").addClass(n),jQuery(".cpw").addClass(n),r=!0)}if(isTerms()&&!isTermsChecked()){var u=jQuery("#idc-hdn-error-terms-privacy").val();o=o+" "+idc_localization_strings.accept_terms+" "+u+".";var r=!0}return r?((p||l)&&(o=o+" "+idc_localization_strings.complete_all_fields+"."),jQuery(".payment-errors").text(o),jQuery("#id-main-submit").text(idc_localization_strings.continue),jQuery("#id-main-submit").removeClass("processing").prop("disabled",!1)):(a=jQuery("#payment-form .email").val(),jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_check_email",Email:a},success:function(e){var t,a,r,n,o,c=JSON.parse(e).response;idcIsLoggedIn()||"exists"!=c?"free"!==idcPayVars.isFree?function e(){var t=jQuery("#extra_fields input, #extra_fields select"),a={posts:{}};jQuery.each(t,function(e,t){var i=jQuery(this).attr("name"),r=jQuery(this).attr("type");"checkbox"==r||"radio"==r?!0==jQuery(this).prop("checked")&&(value=jQuery(this).val(),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value):"SELECT"==this.tagName.toUpperCase()?(value=jQuery(this).find(":selected").val(),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value):(value=encodeURIComponent(jQuery(this).val()),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value)});var r="";jQuery.each(a.posts,function(){r=r+"&"+this.name+"="+this.value});var n=parseFloat(jQuery('input[name="pwyw-price"]').val());if("submitPaymentStripe"==jQuery("#id-main-submit").attr("name")){if(jQuery("#id-main-submit").text(idc_localization_strings.processing+"..."),idcPayVars.idSet){var o=jQuery("#payment-form").data("product"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),m=jQuery("#payment-form .email").val(),l=jQuery(".pw").val(),u={product_id:o,first_name:c,last_name:p,email:m,pw:l};jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_create_customer",Source:"stripe",Customer:u,Token:"customer",Fields:a.posts,txnType:d,Renewable:s,PWYW:n},success:function(e){if(console.log(e),"success"==(json=JSON.parse(e)).response){var t=json.paykey,i=json.product,s=json.order_id,n=json.user_id,o=json.type,c=json.customer_id;jQuery(document).trigger("idcPaymentSuccess",[s,c,n,i,t,a,o]),jQuery(document).trigger("stripeSuccess",[s,c,n,i,t,a,o]),setTimeout(function(){window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+i+"&paykey="+t+r},1e3)}else jQuery("#id-main-submit").prop("disabled",!1).text("").removeClass("processing"),"pay-with-paypal"==jQuery(".payment-type-selector .active").attr("id")?jQuery("#id-main-submit").text(idc_localization_strings.pay_with_paypal):jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(json.message)}})}else{var c=jQuery(".first-name").val(),p=jQuery(".last-name").val();try{Stripe.createToken({number:jQuery(".card-number").val(),cvc:jQuery(".card-cvc").val(),exp_month:jQuery(".card-expiry-month").val(),exp_year:jQuery(".card-expiry-year").val(),name:c+" "+p,address_zip:jQuery(".zip-code").val()},h)}catch(y){jQuery("#id-main-submit").prop("disabled",!1).removeClass("processing"),jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(idc_localization_strings.stripe_credentials_problem_text)}}return!1}if("submitPaymentFD"==jQuery("#id-main-submit").attr("name")){jQuery("#id-main-submit").text(idc_localization_strings.processing+"...");var o=jQuery("#payment-form").data("product"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),m=jQuery("#payment-form .email").val(),l=jQuery(".pw").val(),b=jQuery(".card-number").val(),g=jQuery(".card-expiry-month").val(),k=jQuery(".card-expiry-year").val().slice(-2),w=g+k,u={product_id:o,first_name:c,last_name:p,email:m,pw:l};if(idcPayVars.idSet)var C="customer";else var C="none";return jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_create_customer",Source:"fd",Customer:u,Token:C,Card:b,Expiry:w,Fields:a.posts,txnType:d,Renewable:s,PWYW:n},success:function(e){if(console.log(e),"success"==(json=JSON.parse(e)).response){var t=json.paykey,i=json.product,s=json.order_id,n=json.user_id,o=json.type,c=json.customer_id;jQuery(document).trigger("idcPaymentSuccess",[s,c,n,i,t,a,o]),jQuery(document).trigger("fdSuccess",[s,c,n,i,t,a,o]),setTimeout(function(){window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+i+"&paykey="+t+r},1e3)}else jQuery("#id-main-submit").prop("disabled",!1).text("").removeClass("processing"),"pay-with-paypal"==jQuery(".payment-type-selector .active").attr("id")?jQuery("#id-main-submit").text(idc_localization_strings.pay_with_paypal):jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(json.message)}}),!1}if("submitPaymentMC"==jQuery("#id-main-submit").attr("name")){jQuery("#id-main-submit").text(idc_localization_strings.processing+"...");var o=jQuery("#payment-form").data("product"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),m=jQuery("#payment-form .email").val(),l=jQuery(".pw").val(),u={product_id:o,first_name:c,last_name:p,email:m,pw:l};if(idcPayVars.idSet)var C="customer";else var C="none";return jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_create_customer",Source:"mc",Customer:u,Token:C,Fields:a.posts,txnType:d,Renewable:s,PWYW:n},success:function(e){if(console.log(e),"success"==(json=JSON.parse(e)).response){var t=json.paykey,i=json.product,s=json.order_id,n=json.user_id,o=json.type,c=json.customer_id;jQuery(document).trigger("idcPaymentSuccess",[s,c,n,i,t,a,o]),jQuery(document).trigger("fdSuccess",[s,c,n,i,t,a,o]),setTimeout(function(){window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+i+"&paykey="+t+r},1e3)}else jQuery("#id-main-submit").prop("disabled",!1).text("").removeClass("processing"),"pay-with-paypal"==jQuery(".payment-type-selector .active").attr("id")?jQuery("#id-main-submit").text(idc_localization_strings.pay_with_paypal):jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(json.message)}}),!1}if("submitPaymentAuthorize"==jQuery("#id-main-submit").attr("name")){jQuery("#id-main-submit").text(idc_localization_strings.processing+"...");var o=jQuery("#payment-form").data("product"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),m=jQuery("#payment-form .email").val(),l=jQuery(".pw").val(),b=jQuery(".card-number").val(),g=jQuery(".card-expiry-month").val(),k=jQuery(".card-expiry-year").val().slice(-2),w=g+k,P=jQuery(".card-cvc").val(),u={product_id:o,first_name:c,last_name:p,email:m,pw:l};if(idcPayVars.idSet)var C="customer";else var C="none";return jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_create_customer",Source:"authorize.net",Customer:u,Token:C,Card:b,Expiry:w,CCode:P,Fields:a.posts,txnType:d,Renewable:s,PWYW:n},success:function(e){if("success"==(json=JSON.parse(e)).response){var t=json.paykey,i=json.product,s=json.order_id,n=json.user_id,o=json.type,c=json.customer_id;jQuery(document).trigger("idcPaymentSuccess",[s,c,n,i,t,a,o]),jQuery(document).trigger("authorizeSuccess",[s,c,n,i,t,a,o]),setTimeout(function(){window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+i+"&paykey="+t+r},1e3)}else jQuery("#id-main-submit").prop("disabled",!1).text("").removeClass("processing"),"pay-with-paypal"==jQuery(".payment-type-selector .active").attr("id")?jQuery("#id-main-submit").text(idc_localization_strings.pay_with_paypal):jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(json.message)}}),!1}if("submitPaymentCredits"==jQuery("#id-main-submit").attr("name")){jQuery("#id-main-submit").text(idc_localization_strings.processing+"...");var o=jQuery("#payment-form").data("product"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),u={product_id:o,first_name:c,last_name:p},t=jQuery("#extra_fields input, #extra_fields select"),a={posts:{}};jQuery.each(t,function(e,t){var i=jQuery(this).attr("name"),r=jQuery(this).attr("type");"checkbox"==r||"radio"==r?!0==jQuery(this).prop("checked")&&(value=jQuery(this).val(),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value):"SELECT"==this.tagName.toUpperCase()?(value=jQuery(this).find(":selected").val(),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value):(value=encodeURIComponent(jQuery(this).val()),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value)}),jQuery.each(a.posts,function(){r=r+"&"+this.name+"="+this.value}),jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"md_use_credit",Customer:u,Token:"customer",Fields:a.posts,PWYW:n},success:function(e){if(console.log(e),json=JSON.parse(e)){if("success"==json.response){var t=json.paykey,a=json.product,i=json.order_id,s=json.user_id,n=json.type;jQuery(document).trigger("creditSuccess",[i,null,s,a,t,null,n]),setTimeout(function(){window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+a+"&paykey="+t+r},1e3)}else jQuery("#id-main-submit").prop("disabled",!1).text("").removeClass("processing"),jQuery(".payment-type-selector .active").attr("id"),jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(json.message)}}})}else if("submitPaymentCoinbase"==jQuery("#id-main-submit").attr("name")){jQuery(document).bind("coinbase_modal_closed",function(e,t){jQuery("#id-main-submit").prop("disabled",!1).text(idc_localization_strings.continue_checkout).removeClass("processing")});var o=jQuery("#payment-form").data("product"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),m=jQuery("#payment-form .email").val(),l=jQuery(".pw").val(),u={product_id:o,first_name:c,last_name:p,email:m,pw:l},t=jQuery("#extra_fields input, #extra_fields select");jQuery.each(t,function(e,t){var i=jQuery(this).attr("name"),r=jQuery(this).attr("type");"checkbox"==r||"radio"==r?!0==jQuery(this).prop("checked")&&(value=jQuery(this).val(),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value):"SELECT"==this.tagName.toUpperCase()?(value=jQuery(this).find(":selected").val(),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value):(value=encodeURIComponent(jQuery(this).val()),a.posts[e]={},a.posts[e].name=i,a.posts[e].value=value)});var r="";jQuery.each(a.posts,function(){r=r+"&"+this.name+"="+this.value}),jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_get_level",Level:o},success:function(e){var t=JSON.parse(e),a=t.recurring_type,s=parseFloat(jQuery('input[name="pwyw-price"]').val()),n=v(json,s);jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_get_coinbase_button",product_id:o,product_name:t.level_name,product_price:n,product_currency:"USD",fname:c,lname:p,email:m,transaction_type:"recurring"==i?"recurring":"",recurring_period:a,guestCheckout:idcPayVars.isGuestCheckout,query_string:r},success:function(e){var t=JSON.parse(e);if("success"==t.response)window.location.href="https://www.coinbase.com/checkouts/"+t.code,jQuery(document).on("coinbase_button_loaded",function(e,a){console.log("#coinbaseload loaded"),jQuery(document).trigger("coinbase_show_modal",t.code),jQuery(document).on("coinbase_payment_complete",function(e,t){jQuery("#payment-form").data("product"),window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+o+"&paykey="+t+r})});else{var a=t.message;jQuery("#id-main-submit").prop("disabled",!1).text("").removeClass("processing"),jQuery(".payment-type-selector .active").attr("id"),jQuery("#id-main-submit").text(idc_localization_strings.continue_checkout),jQuery(".payment-errors").text(a)}}})}}),jQuery("#id-main-submit").text(idc_localization_strings.processing+"...").attr("disabled")}else if("submitPaymentPPAdaptive"==jQuery("#id-main-submit").attr("name")){var o=jQuery("#payment-form").data("product"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),m=jQuery("#payment-form .email").val(),l=jQuery(".pw").val(),u={product_id:o,first_name:c,last_name:p,email:m,pw:l};jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_get_ppadaptive_paykey",product_id:o,Customer:u,Type:"recurring"==i?"recurring":"",PWYW:n,txnType:d,Renewable:s,guestCheckout:idcPayVars.isGuestCheckout,queryString:r},success:function(e){var t=JSON.parse(e);if("success"==t.response){var a,r,s,n,o=(r=navigator.userAgent.toLowerCase(),s="",n="",(r.match(/iPhone|iPad|iPod/i)?(n="ios",s="mobile"):r.match(/Android/i)?(n="android",s="mobile"):r.match(/BlackBerry/i)?(n="blackberry",s="mobile"):r.match(/Opera Mini/i)?(n="unknown",s="mobile"):r.match(/IEMobile/i)?(n="windows",s="mobile"):(n="desktop",s="desktop"),void 0!==a&&!0==a)?n:s);if(console.log("device: "+o),"mobile"==o){var c,p,m,l,u=memberdeck_paypal_adaptive+"?expType=mini&paykey="+t.token;console.log("Loading PayPal page"),c=u,p=t.return_address,navigator.userAgent,l=0,m=window.open(c,"_blank"),l=setInterval(function(){m&&m.closed&&(clearInterval(l),x(p))},1e3)}else f=new PAYPAL.apps.DGFlow({trigger:"ppAdapSubmitBtn"});"recurring"==i||"preauth"==d?(jQuery("#preapprovalkey").val(t.token),jQuery("#ppAdaptiveForm").attr("action",memberdeck_paypal_adaptive_preapproval)):(jQuery("#paykey").val(t.token),jQuery("#ppAdaptiveForm").attr("action",memberdeck_paypal_adaptive)),"mobile"!==o&&jQuery("#ppAdapSubmitBtn").trigger("click")}else jQuery("#id-main-submit").prop("disabled",!1).removeClass("processing").text(idc_localization_strings.pay_with_paypal),jQuery(".payment-errors").text(t.message)}}),jQuery("#id-main-submit").text(idc_localization_strings.processing+"...").attr("disabled")}else if("submitPaymentPaypal"==jQuery("#id-main-submit").attr("name")){jQuery("#id-main-submit").text(idc_localization_strings.processing+"...");var $=jQuery("#payment-form").data("currency-code"),c=jQuery(".first-name").val(),p=jQuery(".last-name").val(),m=jQuery("#payment-form .email").val(),l=jQuery(".pw").val();jQuery(".cpw").val();var o=jQuery("#payment-form").data("product"),n=parseFloat(jQuery('input[name="pwyw-price"]').val());jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_get_level",Level:o},success:function(e){if(json=JSON.parse(e)){var t,a,s,o=idcCheckoutExtraFields(),d=o.posts[1].value,l=o.posts[2].value;if(null!==idcPayVars.claim_paypal&&idcPayVars.claim_paypal.length>1&&(memberdeck_pp=idcPayVars.claim_paypal),t=json,a=n,s=v(t,a),jQuery("#buyform input#pp-price").val(s),"recurring"==i){var u=json.recurring_type.charAt(0).toUpperCase();jQuery("#buyform input#pp-times").val(1),jQuery("#buyform input#pp-recurring").val(u),1==json.trial_period?(jQuery('#buyform input[name="a1"]').val("0"),jQuery('#buyform input[name="p1"]').val(json.trial_length),jQuery('#buyform input[name="t1"]').val(json.trial_type.charAt(0).toUpperCase())):(jQuery('#buyform input[name="a1"]').remove(),jQuery('#buyform input[name="p1"]').remove(),jQuery('#buyform input[name="t1"]').remove())}jQuery("#buyform").attr("action",memberdeck_paypal),jQuery('#buyform input[name="currency_code"]').val($),jQuery('#buyform input[name="item_number"]').val(json.id),jQuery('#buyform input[name="item_name"]').val(json.level_name),jQuery('#buyform input[name="return"]').val(memberdeck_returnurl+permalink_prefix+"ppsuccess=1&project_id="+d+"&project_level="+l+"&first_name="+c+"&last_name="+p+"&email="+m+"&idc_orders=1&memberdeck_notify=pp"),jQuery('#buyform input[name="cancel_return"]').val(memberdeck_returnurl+permalink_prefix+"ppsuccess=0"),jQuery('#buyform input[name="notify_url"]').val(memberdeck_siteurl+permalink_prefix+"memberdeck_notify=pp_notify&project_id="+d+"&project_level="+l+"&first_name="+c+"&last_name="+p+"&email="+m+"&guest_checkout="+idcPayVars.isGuestCheckout+r),jQuery('#buyform input[name="business"]').val(memberdeck_pp),jQuery('#buyform input[name="discount_amount"]').val("0").remove(),jQuery("#buyform").submit()}}})}jQuery(document).trigger("idcPaymentChecksAfter",[n,r,a])}():(t=jQuery(".first-name").val(),a=jQuery(".last-name").val(),r=jQuery("#payment-form .email").val(),n=jQuery(".pw").val(),jQuery(".cpw").val(),o={product_id:jQuery("#payment-form").data("product"),first_name:t,last_name:a,email:r,pw:n},jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_free_product",Customer:o},success:function(e){if(console.log(e),"success"==(json=JSON.parse(e)).response){var t=json.product;window.location=idcPayVars.redirectURL+permalink_prefix+"idc_product="+t,jQuery(document).trigger("idcFreeSuccess",o)}}})):(jQuery(".payment-errors").html('<span id="email-error">'+idc_localization_strings.email_already_exists+"<br>"+idc_localization_strings.please+' <a class="login-redirect" href="'+memberdeck_durl+'">'+idc_localization_strings.login+"</a></span>"),jQuery("#id-main-submit").prop("disabled",!1),jQuery("#email-error .login-redirect").click(function(e){e.preventDefault(),jQuery("#payment-form").hide(),jQuery(".login-form").show()}))}})),r}()){var a=jQuery(this).attr("name");"1"==es&&"free"!==idcPayVars.isFree&&(jQuery(".pay_selector").length>1?jQuery("#pay-with-stripe").hasClass("active")&&Stripe.setPublishableKey(memberdeck_pk):Stripe.setPublishableKey(memberdeck_pk)),jQuery(document).trigger("idcCheckoutSubmit",a)}}),jQuery("form[name='reg-form']").on("submit",function(t){t.preventDefault(),jQuery(".payment-errors").text(""),jQuery("#id-reg-submit").attr("disabled","disabled").prop("disabled",!0);var a=jQuery(".first-name").val(),i=jQuery(".last-name").val(),r=jQuery("#payment-form .email").val(),s=jQuery(".pw").val(),n=jQuery(".cpw").val(),o=jQuery("form[name='reg-form']").data("regkey");jQuery(this).find("input, select").removeClass(e);var c=!0,p=!1;if((void 0==o||""==o)&&(c=!1),s!==n){jQuery(".payment-errors").text(idc_localization_strings.passwords_mismatch_text);var d=!0}if(a.length<1||i.length<1||!1==idfValidateEmail(r)||s.length<5)var d=!0;var m=jQuery('form[name="reg-form"] input.required:visible, form[name="reg-form"] select.required:visible');if(jQuery.each(m,function(t,a){var i=jQuery(a).val();"checkbox"==jQuery(a).attr("type")?"0"==jQuery(a).prop("checked")&&(jQuery(this).addClass(e),d=!0,p=!0):(""==i||void 0===i)&&(jQuery(this).addClass(e),d=!0,p=!0)}),!0==d)return jQuery(".payment-errors").append(idc_localization_strings.registration_fields_error_text),jQuery("#id-reg-submit").prop("disabled",!1).removeClass("processing"),!1;if(!0==c){var l={regkey:o,first_name:a,last_name:i,email:r,pw:s};jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_update_user",User:l},success:function(e){"success"==(json=JSON.parse(e)).response?window.location=memberdeck_durl+permalink_prefix+"account_updated=1":json.message?jQuery(".payment-errors").text(json.message):jQuery(".payment-errors").text(idc_localization_strings.error_in_processing_registration_text)}})}else{var l={first_name:a,last_name:i,email:r,pw:s},u=jQuery("#registration-form-extra-fields").find("select, textarea, input"),y={posts:{}};jQuery.each(u,function(e,t){var a=jQuery(this).attr("name"),i=jQuery(this).attr("type");"checkbox"==i||"radio"==i?!0==jQuery(this).prop("checked")&&(value=jQuery(this).val(),y.posts[e]={},y.posts[e].name=a,y.posts[e].value=value):jQuery(this).is("select")?(value=jQuery(this).find("option:selected").val(),y.posts[e]={},y.posts[e].name=a,y.posts[e].value=value):(value=jQuery(this).val(),y.posts[e]={},y.posts[e].name=a,y.posts[e].value=value)}),jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"memberdeck_insert_user",User:l,Fields:y.posts},success:function(e){"success"==(json=JSON.parse(e)).response?window.location=memberdeck_durl+permalink_prefix+"account_created=1":(jQuery("#id-reg-submit").prop("disabled",!1),json.message?jQuery(".payment-errors").text(json.message):jQuery(".payment-errors").text(idc_localization_strings.error_in_processing_registration_text))}})}}),jQuery("#idc-downloads .inactive").on("click",function(e){if(e.preventDefault(),jQuery(".oneclick").on("click",function(){var e=jQuery(this).attr("href");window.location.href=e}),"open"==jQuery(".buy-tooltip").data("closing"))return!1;if(b(),"processing"==jQuery(".buy-tooltip").data("closing"))return jQuery(".buy-tooltip").data("closing","closed"),!1;var t=jQuery(this).data("levelid"),a=jQuery(this).data("pid"),i=jQuery(this).children(".inactive-item").attr("href"),r=jQuery(this).children(".tooltip-wrapper");if(t>0){var s=jQuery(this).offset();s.top,s.left,jQuery(this).height(),jQuery(this).width(),jQuery(".buy-tooltip").height(),jQuery(".components button").width(),jQuery(".components button").height(),jQuery(".components button").css("padding-top").replace("px",""),jQuery(".buy-tooltip").width();var n=jQuery(".buy-tooltip").css("padding-top").replace("px","");jQuery(".buy-tooltip").css("padding-left").replace("px",""),ttTotalTop=2*n;var o=!0;jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"md_level_data",level_id:t,get_instant_checkout:"true"},success:function(e){if(json=JSON.parse(e)){var s=json.instant_checkout;json=json.level,jQuery(".buy-tooltip").data("levelid",t),jQuery(".buy-tooltip").data("pid",a);var n=jQuery(".buy-tooltip");if((jQuery(n).find(".tt-product-name").text(json.level_name),jQuery(n).find(".tt-price").text(json.level_price),json.credit_value>0)?(jQuery(n).find(".tt-credit-value").text(json.credit_value),parseFloat(jQuery(".credits-avail").data("credits-available"))>=json.credit_value&&jQuery('[name="occ_method"]').children('option[value="credit"]').length<=0&&jQuery('[name="occ_method"]').append(jQuery("<option/>",{value:"credit",text:idc_localization_strings.pay_with_credits}))):(jQuery(".tt-credit-sep, .credits-avail, .credit-text").hide(),jQuery('[name="occ_method"]').children('option[value="credit"]').remove()),!1==s&&json.credit_value<=0&&(o=!1,window.location=i),1==jQuery('[name="occ_method"]').children(":enabled").length?(jQuery('[name="occ_method"]').children('option[value=""]').html(idc_localization_strings.no_payment_options),o=!1,window.location=i):jQuery('[name="occ_method"]').children(":enabled").length>1&&jQuery('[name="occ_method"]').children('option[value=""]').html(idc_localization_strings.select_payment_option),json.credit_value>1){var c=jQuery(n).find(".credit-text");c.text(c.data("credit-label-p"))}else{var c=jQuery(n).find(".credit-text");c.text(c.data("credit-label-s"))}jQuery(".tt-more").attr("href",i),o&&(jQuery(n).show().data("closing","open"),jQuery(r).append(jQuery(".buy-tooltip")),jQuery(window).trigger("tt_open",[r,json]))}}})}else window.location.href=i}),jQuery(".tt-close").on("click",function(e){e.preventDefault(),jQuery(".buy-tooltip").data("closing","processing"),b()}),jQuery('select[name="occ_method"]').on("change",function(){jQuery('select[name="occ_method"]').val().length>0?jQuery(".md_occ").prop("disabled",!1):jQuery(".md_occ").attr("disabled","disabled")}),jQuery(".md_occ").on("click",function(e){e.preventDefault(),jQuery(this).attr("disabled","disabled").addClass("processing"),jQuery(this).text(idc_localization_strings.processing);var t=jQuery('select[name="occ_method"]').val(),a=jQuery(".buy-tooltip").data("levelid"),i=jQuery(".buy-tooltip").data("pid"),r=jQuery(".md-firstname").text(),s=jQuery(".md-lastname").text(),n={product_id:a,first_name:r,last_name:s};"cc"==t?jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idmember_create_customer",Source:null,Customer:n,Token:"customer",Fields:[{name:"project_id",value:i},{name:"project_level",value:0}],txnType:null},success:function(e){if("success"==(json=JSON.parse(e)).response){var t=json.paykey,a=json.product,i=json.order_id,r=json.user_id,s=json.type,n=json.customer_id;jQuery(document).trigger("idcPaymentSuccess",[i,n,r,a,t,null,s]),jQuery(document).trigger("stripeSuccess",[i,n,r,a,t,null,s]),window.location="?idc_product="+a+"&paykey="+t}else jQuery(".md_occ").prop("disabled",!1).removeClass("processing"),jQuery(".md_occ").text("Confirm")}}):"credit"==t?jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"md_use_credit",Customer:n,Token:"customer",PWYW:l},success:function(e){if(json=JSON.parse(e)){if("success"==json.response){var t=json.paykey,a=json.product,i=json.order_id,r=json.user_id,s=json.type;jQuery(document).trigger("creditSuccess",[i,null,r,a,t,null,s]),window.location="?idc_product="+a+"&paykey="+t}else jQuery(".md_occ").prop("disabled",!1).removeClass("processing")}}}):jQuery(".md_occ").prop("disabled",!1).removeClass("processing")}),jQuery("div#idc_ppadap_return").length>0&&window!=top&&top.location.replace(document.location),jQuery('select[name="sub_list"]').on("change",function(){"0"!==jQuery(this).children("option:selected").val()?(jQuery(this).children("option:selected").text(),jQuery('button[name="cancel_sub"]').prop("disabled",!1).show()):jQuery('button[name="cancel_sub"]').prop("disabled",!0).hide()}),jQuery('button[name="cancel_sub"]').on("click",function(e){e.preventDefault(),jQuery(".sub_response").text("").removeClass().addClass("sub_response");var t=jQuery('select[name="sub_list"]').children("option:selected").val(),a=jQuery('select[name="sub_list"]').children("option:selected").text(),i=jQuery('select[name="sub_list"]').data("userid"),r=jQuery('select[name="sub_list"]').val(),s=jQuery('select[name="sub_list"] option[value="'+r+'"]').data("gateway");jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"idc_cancel_sub",plan_id:t,plan:a,user_id:i,payment_gateway:s},success:function(e){if(e){var t=JSON.parse(e);"success"==t.status&&(jQuery('select[name="sub_list"] option:selected').remove(),1==jQuery('select[name="sub_list"] option').size()&&jQuery('button[name="cancel_sub"]').attr("disabled","disabled").hide()),jQuery(".sub_response").text(t.message).addClass(t.status)}}})}),jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"mdid_project_list"},success:function(e){"0"!==e&&(json=JSON.parse(e),jQuery.each(json,function(e,t){jQuery.each(jQuery(".id-full, #ign-product-levels, .widget_level_container"),function(){jQuery(this);var e=jQuery(this).data("projectid");if(t&&e==t.id){var a=jQuery(this).find(".level-binding");jQuery.each(a,function(e,t){var a=jQuery(this).attr("href");if(a&&-1==a.indexOf("mdid")){var i=a.replace("prodid","mdid_checkout");jQuery(this).attr("href",i)}});var i=jQuery(this).attr("id");i&&i.indexOf("ign-product-levels")}})}))}}),jQuery(".payment-settings").length>0&&jQuery(".payment-settings input").length<=1&&jQuery(".payment-settings .submit").hide(),jQuery('input[name="ide_fes_file_upload_submit"]').on("click",function(e){jQuery(".required").removeClass("error");var t=!1;if(jQuery.each(jQuery('form[name="ide_fes_file_upload_form"] input'),function(){jQuery(this).val().length<=0&&"submit"!=jQuery(this).attr("type")&&(jQuery(".required").addClass("error"),console.log(this),t=!0)}),t)return!1}),jQuery(".content_tabs").length>0){var g=jQuery(this).find(".ign_backer_list").data("count");(void 0==g||0==g)&&jQuery("#backers_tab").hide()}jQuery(".backer_list_more a").on("click",function(e){e.preventDefault;var t=jQuery(this).data("first");jQuery(this).data("first",parseInt(t)+20);var a=jQuery(this).data("last");jQuery(this).data("last",parseInt(a)+20),jQuery(this).data("total")<=a+20&&jQuery(this).hide();var i=jQuery(this).data("project");jQuery.ajax({url:memberdeck_ajaxurl,type:"POST",data:{action:"mdid_show_more_backers",Vars:{First:t,Last:a,Project:i}},success:function(e){if(e){var t=JSON.parse(e);jQuery(".ign_backer_list li").last().after(t),jQuery(".ign_backer_list li.new_backer_item").fadeIn("slow").removeClass("new_backer_item"),jQuery(document).trigger("backer_list_more")}}})}),jQuery(".md-requiredlogin").length>0&&jQuery('.md-requiredlogin input[name="wp-submit"]').on("click",function(e){var t=!1,a=!1,i=!1;return(""===jQuery('.md-requiredlogin input[name="log"]').val()&&(t=!0,a=!0),""===jQuery('.md-requiredlogin input[name="pwd"]').val()&&(t=!0,i=!0),t&&(a||i))?(jQuery(".md-requiredlogin .error.blank-field").removeClass("hide"),!1):!t}),jQuery("#edit-profile-submit").on("click",function(e){var t=!1,a=jQuery(".email").val();if(!1==idfValidateEmail(a)?(t=!0,jQuery(".email").addClass("error")):jQuery(".email").removeClass("error"),t){var i=jQuery(".error").get(0),r=jQuery(i).offset().top-55;jQuery("html, body").animate({scrollTop:r},500)}return!t});var x=function(e){location.replace(e)}}),jQuery(document).on("idcCheckoutLoaded",function(e){if(setGuestCheckout(),setIdcPayObj(),"BTC"==memberdeck_global_currency&&(jQuery(".payment-type-selector > div").each(function(){"pay-with-cps"!=jQuery(this).find("> a").prop("id")&&jQuery(this).remove()}),!jQuery("#pay-with-cps").length)){var t=parseFloat(jQuery('input[name="pwyw-price"]').val());parseFloat(t)>0&&(jQuery(".payment-errors").text("Please enable Cryptocurrency Payment Gateway like CoinPayments."),jQuery(".payment-errors").show())}});